{% extends 'home/base_home.html' %}
{% load bootstrap %}
{% load wagtailcore_tags register_tags %}
{% block content %}
  <style>
  @media screen and (max-width: 768px) {
    .select2 {
        width: 95% !important;
    }
      #button-center{
          text-align: center;
      }
}
    .select2 {
        width:96%!important;
    }
  .help-block
  {
     display: none;
  }
.select2-container--open .select2-dropdown--below
    {
       margin-left:25px;
    }
.select2-container--open .select2-dropdown--above
    {
       margin-left:25px;
    }
.select2-container--default .select2-selection--single
{
    {#border: 2px solid #aaa;#}
    height:35px;
    margin-left:3%;
    margin-right: -2%;
    max-width: 100%;
}
    label
    {
        margin-left: 25px;
        font-weight: bold;
    }
    label[for=id_project_name]:after,label[for=id_engagement_type]:after,label[for=id_activity_type]:after,label[for=id_form-0-campus_partner]:after,
        label[for=id_facilitator]:after,label[for=id_status]:after,label[for=id_status]:after,label[for=id_academic_year]:after,label[for=id_semester]:after,label[for=id_uno_student_service_hours]:after,
        label[for=id_address_line1]:after,label[for=id_city]:after,label[for=id_state]:after,label[for=id_country]:after,label[for=id_zip]:after,label[for=id_form-0-mission_type]:after,
        label[for=id_form-0-mission]:after,label[for=id_zip]:after,label[for=id_campus-0-campus_partner]:after
    {
        content:"*" ;
        color:red
    }
    h4
    {
        line-height: 2.7;
        font-size: 1.3em;
    }
    .h9{
        font-size:0.8em;
    }
    .btn-link{
        font-size: small;
    }
    select[id=id_engagement_type],input[id=id_project_name], select[id=select2-id_activity_type-container],select[id=id_semester],select[id=id_status],select[id=id_academic_year],
   input[id=id_address_line1],input[id=id_city],input[id=id_state],input[id=id_zip],input[id=id_country],input[id=id_total_uno_students], input[id_k12_flag=checked],input[id=id_total_uno_hours],input[id=id_total_k12_students], input[id=id_total_k12_hours],
    select[id=id_end_semester],select[id=id_end_academic_year],input[id=firstname],input[id=lastname],input[id=otheracttype],
     input[id=id_total_uno_faculty],input[id=id_total_other_community_members]
    {
        width:96%;
        height: 35px;
        color: black;
        margin-top: 5px;
        margin-left: 10px;
         font-family: "Arial Narrow", sans-serif;
        font-size: 16px;
        border-radius: 5px;
    }
    input[id=id_project_name]{
        margin-bottom: 0px;
        border-radius: 5px;
    }
    .panel {
  margin-bottom: 20px;
  background-color: #ffffff;
  border: 1px solid transparent;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
          box-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
}
  select[id=id_form-0-campus_partner]
   {
       width:93%;
   }
  .form-control{
      border: 1px solid #aaaaaa ;
  }
   .btn-link, .btn-link:hover
   {
   color: #d71920
   }
/*K12 Checkbox-Parimita*/
/*input[type="radio"]:checked ~ .reveal-if-active,*/
/*input[type="checkbox"]:checked ~ .reveal-if-active {*/
/*  opacity: 1;*/
/*  max-height: 110px;*/
/*  overflow: visible;*/
/*    !*line-height: 2.7;*!*/
/*    font-size: 1.00em;*/
/*}*/
  /*.reveal-if-active {*/
  /*    opacity: 0;*/
  /*    max-height: 0;*/
  /*    overflow: hidden;*/
  /*    !*transform: scale(0.8);*!*/
  /*    transition: 0.5s;*/
  /*    margin-left: 0px;*/
  /*}*/
  /*input[type="radio"]:checked ~ &,*/
  /*input[type="checkbox"]:checked ~ & {*/
  /*  opacity: 1;*/
  /*  max-height: 100px;*/
  /*  overflow: visible;*/
  /*  padding: 10px 20px;*/
  /*  transform: scale(1);*/
  /*    margin-left: 0px;*/
  /*}*/
.colpanel-default > .colpanel-heading {
        background-color: lightgrey;
    height: 33px;
    }
    .formtabfont a,i,h2{
        font-family: "Arial Narrow", sans-serif;
        color: black;
        padding: 0;
        align-content: center;
        /*background-color: lightgrey;*/
    }
    .formtabfont h2:hover{
        font-family: "Arial Narrow", sans-serif;
        color: black;
        text-decoration: underline;
        padding: 0;
        align-content: center;
        /*background-color: lightgrey;*/
    }
.panel{
    margin-bottom: 10px;
    margin-top: 10px;
}
.icon{
    margin-top: 33px;
}
textarea[id=id_description]{
    height:110px;
}
footer{
    position: relative;
}
label[for=id_campus-0-campus_partner]:after{
    display: none;
    content: " ";
}
.delicon{
    color: red;
}
      .form-control{
          margin: 5px;
          width:100%
      }
      .sw-btn-prev{
          float: left;
      }
      .collapsible {
  background-color: #C1C0C0;
  color: black;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
}
.active, .collapsible:hover {
  background-color: #E1E1E1;
}
.content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: #f1f1f1;
}
      input[id=othersubcat]{
        width:98%;
        height: 35px;
        color: black;
        margin-top: 5px;
        margin-left: 8px;
        font-family: "Arial Narrow", sans-serif;
        font-size: 16px;
          border-radius: 5px;
    }
    </style>
                           <form method="POST">{% csrf_token %}
                                {{formset_missiondetails.management_form}}

                                {{formset_comm_details.management_form}}
                                {{formset_camp_details.management_form}}
                               {{formset_subcat_details.management_form}}
                               <input type="hidden" id="id_projectId" value="{{projectId}}" />

<div class="container-fluid">

    <div class="row justify-content-md-center">
            <div class="col-lg-12 col-md-12">

                          <div class=" text-center"><h3 class="heading">Edit Project</h3></div>
<div class="card snippet-card">
    <div class="container text-snippet">
       {% edit_project_forms %}
    </div>
</div>

<!--                       <div class="panel-body">-->
<div class="box">
<div id="smartwizard">
    <ul>
        <li><a href="#step-1" id="click1">Project Information</a></li>
        <li><a href="#step-2">Partner Information</a></li>
        <li><a href="#step-3">Focus Areas</a></li>
        <li id="click4"><a href="#step-4" >Location</a></li>
    </ul>
    <div>
        <div id="step-1">
            <div id="form-step-0">
                <br>
                <div class="row">
                <div class="col-md-6">
                    <div class="row">
                    <label for="id_project_name" class="col-sm-4"><i  style="padding-left: 15px"></i> Project Name</label>
                    <div class="col-sm-7">
                    {{ project.project_name }}
                    </div>
<!--                    {% if  project.project_name.errors %}-->
<!--                    {% for error in  project.project_name.errors %}-->
<!--                    <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>-->
<!--                    {% endfor %}-->
<!--                    {% endif %}-->
                </div>
                    <div class="row">
                          {% for data_definition in data_definition %}
                    {% if data_definition.id == 31%}
                        <label for="id_engagement_type" data-toggle="tooltip" title="{{ data_definition.description }}" class="col-sm-4">
                        <i class="fa fa-info-circle"></i> Engagement Type
<!--                            <span class="tooltip">{{ data_definition.description }}</span>-->
                            </label>
                         {% endif %}
                    {% endfor %}
                        <div class="col-sm-7">
                    {{ project.engagement_type }}
                        </div>
                    {% if  project.engagement_type.errors %}
                    {% for error in  project.engagement_type.errors %}
                    <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                    {% endfor %}
                    {% endif %}
                </div>
                    <div class="row">
                         {% for data_definition in data_definition %}
                      {% if data_definition.id == 42%}
                      <label class="col-sm-4"  data-toggle="tooltip" title="{{ data_definition.description }}">
                        <i class="fa fa-info-circle"></i> Activity Type <span style="color:red;">*</span></label>
                      {% endif %}
                      {% endfor %}
                        <div class="col-sm-7">
                      <select id="id_populate_activity" name="name_populate_activity">
                          <option value = "0">--------</option>
                        {% for act in activityList %}
                        {% if act.selected == 'selected' %}
                        <option value={{act.id}} selected="selected">{{act.name}}</option>
                        {% else %}
                        <option value={{act.id}}>{{act.name}}</option>
                          {% endif %}
                        {% endfor %}
                     </select>
                            <div style="display: none">
                      {{ project.activity_type }}
                        </div>
                     </div>
                    </div>
<div class="row centered"><span class="addactivityerror" style="color: #b60000"></span> </div>
                    <div class="row" id="otheractivity">

                      <label class="col-sm-4"><i  style="padding-left: 15px"></i> Other Activity Type</label>
                             <div class="col-md-6">
                                 <input id='otheracttype' type="text" class="inputbox" placeholder="Add Other Activity Types">
                                                    </div>

                                                    <div class="col-md-1">
<!--                                                        <div><br></div>-->
                                                <div class="input-group-append" >
                                                <i class="fa fa-plus-square fa-2x" style="padding-top: 8px" id="addotheract" aria-hidden="true"></i>
                                            </div>
                                            </div>
                                                </div>
                                            <div style="display: none">
<!--                                                <div>-->
                                            {{ project.other_activity_type}}
                                            </div>
                                        <div class="row displaybox" id='displayact'>
                                        </div>
                </div>

                <div class="col-md-6">
                    <div class="row">
                    <label  for="id_semester"  class="col-sm-2">Description</label>
<!--                    </div>-->
<!--                    <div class="row">-->
                    <div class="col">
                    {{ project.description }}
                    </div>
                    {% if  project.description.errors %}
                    {% for error in  project.description.errors %}
                    <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                    {% endfor %}
                    {% endif %}
                </div>
                </div>
                </div>
<!--                                <div class="row">-->
<!--                    <div class="col-md-6">-->
<!--                        <div class="row centered"><span class="addactivityerror" style="color: #b60000"></span> </div>-->
<!--                <div class="row" id="otheractivity">-->
<!--                      <label class="col-sm-4"><i  style="padding-left: 15px"></i>  Other Activity Type</label>-->
<!--                             <div class="col-md-6">-->
<!--                                 <input id='otheracttype' type="text" class="inputbox" placeholder="Add Other Activity Types">-->
<!--                             <div class="row displaybox" id='displayact'>-->
<!--                                        </div>-->
<!--                             </div>-->

<!--                                                    <div class="col-md-1">-->
<!--&lt;!&ndash;                                                        <div><br></div>&ndash;&gt;-->
<!--                                                <div class="input-group-append" >-->
<!--                                                <i class="fa fa-plus-square fa-2x" style="padding-top: 8px" id="addotheract" aria-hidden="true"></i>-->
<!--                                            </div>-->
<!--                                            </div>-->
<!--                                                </div>-->
<!--                                            <div style="display: none">-->
<!--&lt;!&ndash;                                                <div>&ndash;&gt;-->
<!--                                            {{ project.other_activity_type}}-->
<!--                                            </div>-->

<!--                    </div>-->
<!--                </div>-->

                    <button type="button" class="collapsible card-header" style="background-color: lightgrey;height: 30px;padding:5px" data-toggle="collapse" href="#academicinfo">
                    <i class="fa fa-plus"></i> Project Duration <span style="color:red;">*</span>
                    </button>

                    <div id="academicinfo" class= "panel-collapse collapse">
                                    <div class="panel-body">
                                        <br>             <div class="row">
                                            <div class="col-md-6">
                                                <div class="row">
                      <label class="col-sm-5"> Project Type</label>
                        <div class="col-sm-6">
                      {{ project.project_type }}
                        </div>
                                                </div>
                                            </div>
</div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row">
                                                    <label for="id_semester" class="col-md-5">Start Semester</label>
                                                <div class="col-sm-6">
                                                    {{ project.semester}}
                                                </div>
                                                    {% if  project.semester.errors %} {% for error in  project.semester.errors %}
                                                    <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                    {% endfor %} {% endif %}
                                                </div>
                                                    <div class="row">
                                            <label class="col-md-5">End Semester</label>
                                                <div class="col-sm-6">
                                                {{ project.end_semester}}
                                                </div>
                                                {% if  project.end_semester.errors %} {% for error in  project.end_semester.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}

                                            </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="row">
                                                    <label for="id_academic_year" class="col-md-5">Start Academic Year</label>
                                                    <div class="col-sm-6">
                                                    {{ project.academic_year}}
                                                    </div>
                                                    {% if  project.academic_year.errors %} {% for error in  project.academic_year.errors %}
                                                    <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                    {% endfor %} {% endif %}
                                                    </div>
                                                    <div class="row">
                                                <label class="col-md-5">End Academic Year</label>
                                                <div class="col-sm-6">
                                                {{ project.end_academic_year}}
                                                </div>
                                                {% if  project.end_academic_year.errors %} {% for error in  project.end_academic_year.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}
                                            </div>
                                                </div>
                                        </div>


                                        </div>


                    </div>
                <div class="row"><br></div>
                <button type="button" class="collapsible card-header" style="background-color: lightgrey;height: 30px;padding:5px" data-toggle="collapse" href="#studentinfo">
                    <i class="fa fa-plus"></i> Student Information
                    </button>

                    <div id="studentinfo" class= "panel-collapse collapse">
                                    <div class="panel-body">
                                        <br>
                                        <div class="row">
                                            <div class="col">
                                                 <div class="row">
                                                <label for="id_uno_students" class="col-sm-5">Total UNO Students</label>
                                                    <div class="col-sm-6">
                                                {{ project.total_uno_students}}
                                                    </div>
                                                {% if  project.total_uno_students.errors %} {% for error in  project.total_uno_students.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}
                                            </div>
                                            </div>
                                            <div class="col">
                                                <div class="row">
                                                <label for="id_uno_hours" class="col-sm-5">UNO Student Hours</label>
                                                <div class="col-sm-6">
                                                {{ project.total_uno_hours}}
                                                </div>
                                                {% if  project.total_uno_hours.errors %} {% for error in  project.total_uno_hours.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                           <div class="row">
                                            <div class="col">
                                                 <div class="row">
                                                <label for="id_uno_students" class="col-sm-5">UNO Faculty/Staff Hours</label>
                                                    <div class="col-sm-6">
                                                {{ project.total_uno_faculty}}
                                                    </div>
                                                {% if  project.total_uno_students.errors %} {% for error in  project.total_uno_students.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}
                                            </div>
                                            </div>
                                            <div class="col">
                                                <div class="row">
                                                <label for="id_uno_hours" class="col-sm-5">Total Number of Other Participants</label>
                                                <div class="col-sm-6">
                                                {{ project.total_other_community_members}}
                                                </div>
                                                {% if  project.total_uno_hours.errors %} {% for error in  project.total_uno_hours.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                            <label for="id_k12_flag">Does this Project involve K-12 students?</label>
                                            {{ project.k12_flag}}
                                            </div>
                                        </div>
                                        <div class="row" id ="k12-students">
                                            <div class="form-group-row col">
                                                <div class="row">
                                                <label for="id_k12_students" class="col-sm-5">Total number of K-12 Students:</label>
                                                 <div class="col-sm-6">
                                                {{ project.total_k12_students}}
                                                 </div>
                                                {% if  project.total_k12_students.errors %} {% for error in  project.total_k12_students.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}
<!--                                                </div>-->
                                            </div>
                                            </div>
                                            <div class="form-group-row col">
                                                <div class="row">
                                                <label for="id_k12_hours" class="col-sm-5">Total number of K-12 Hours:</label>
                                                 <div class="col-sm-6">
                                                {{ project.total_k12_hours}}
                                                 </div>
                                                {% if  project.total_k12_hours.errors %} {% for error in  project.total_k12_hours.errors %}
                                                <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                                {% endfor %} {% endif %}
<!--                                                </div>-->
                                                </div>
                                            </div>
                                        </div>
                                        </div>

                        </div>
                    </div>
 <div class="row justify-content-end" style="margin-top:30px;">
<div class="col-md-3" style="float: right">
<!--                    <p id="button-center"><button type="submit" class="save blackbutton" > <i class="fa fa-arrow-circle-right" style="color: white" aria-hidden="true"></i> Save as Draft</button></p>-->
            </div>
 </div>
        </div>

        <div id="step-2">
<!--{{ communitypartner }}-->

            <div class="row"><br></div>

<!--                <button type="button" class="collapsible card-header" style="background-color: lightgrey;height: 30px;padding:5px" data-toggle="collapse" href="#communityinfo">-->
<!--                    <i class="fa fa-plus"></i> <span tabindex="-1" data-toggle="popover" data-trigger="focus" data-content="{{ data_definition.description }}" class="float">-->
<!--                    {% for data_definition in data_definition %}-->
<!--                                              {% if data_definition.id == 2%} Community Partner Information-->

<!--                                          {% endif %}-->
<!--                                          {% endfor %}-->
<!--                                          </span>-->
<!--                    </button>-->
            <div id="communityinfo" class= "panel-collapse collapse show">
                {% for commform in formset_comm_details %}
                                    <div class="panel-body community_edit-row">
                                        <br>
                                        <div class="row centered" ><span class="addcommerror" style="color: #b60000"></span> </div>
                                            <div class="row">
                                                <div class="col-md-3">
                                               {% for data_definition in data_definition %}{% if data_definition.id == 2%}
                                                <label style="padding-top:8px" data-toggle="tooltip" title="{{ data_definition.description }}"><i class="info"></i> Community Partner</label>
                                                    {% endif %}
                                                    {% endfor %}
                                            </div>
                                            <div class="col-md-4">
                                                {{ commform|bootstrap }}
                                                {% if  commform.errors %}
                                        {% for error in  commform.errors %}
                                        <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                        {% endfor %}
                                        {% endif %}
                                            </div>
                                                <div class="col-md-1">
                                            <i class="centered fa fa-plus-square fa-2x add-community-row" onClick="clickCommunity()" style="padding-top:8px; " aria-hidden="true"></i>
                                            </div>
                                        </div>


                                    </div>
                {% endfor %}
                <div class="community_edit-fields displaybox row" id="community_edit-fields"></div>
                    <div class="row centered">
                                               <a class="btn btn-link" href="javascript:void(0);" style="color: #d71920;background:none;" id="id_registerCommAndSave" >Not in list? Register a New Community Partner</a>

                                        </div>
            </div>



            <div class="row"><br></div>
                <button type="button" class="collapsible card-header" style="background-color: lightgrey;height: 30px;padding:5px" data-toggle="collapse" href="#campusinfo">
    <i class="fa fa-plus"></i>
                                 Campus Partner Information <span style="color:red;">*</span>

</button>
<div id="campusinfo" class= "panel-collapse collapse">
{% for campform in formset_camp_details %}
    <div class="row centered" ><span class="addcamperror" style="color: #b60000"></span> </div>
                                    <div class="panel-body campus_edit-row">

                                        <br>
                                        <div class="row ">
                                            <div class="col-md-3">
                                                 {% for data_definition in data_definition %}
                                {% if data_definition.id == 1%}
                                                <label for="id_academic_year" style="padding-top:8px" data-toggle="tooltip" title="{{ data_definition.description }}"><i class="info"></i> Campus Partner </label>
                                                 {% endif %}
                                {% endfor %}
                                            </div>
                                            <div class="col-md-4">
                                                 {{ campform|bootstrap }}
                                                {% if  commform.errors %}
                                        {% for error in  commform.errors %}
                                        <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                        {% endfor %}
                                        {% endif %}
                                        </div>
                                        <div class="col-md-1">
                                            <div class="input-group-append" >
                                                <i class="centered fa fa-plus-square fa-2x add-campus-row" onClick="clickCampus()" style="padding-top:8px" aria-hidden="true"></i>
                                            </div>
<!--                                            <i class="fa fa-plus-square fa-2x add-community-row" style="padding-tp:40px; " aria-hidden="true"></i>-->
                                            </div>
                                        </div>

                                    </div>
    {% endfor %}
    <div class="campus_edit-fields displaybox row" id="campus_edit-fields"></div>
                                                      <div class="row"><br></div>
<div class="centered">

                                             <a class="btn btn-link" href="javascript:void(0);" style="color: #d71920;background:none;" id="id_registerCampusAndSave">Not in list? Register a New Campus Partner</a>
                                        </div>

</div>

            <div class="row"><br></div>
                <button type="button" class="collapsible card-header" style="background-color: lightgrey;height: 30px;padding:5px" data-toggle="collapse" href="#leadstaffinfo">
    <i class="fa fa-plus"></i> Campus Staff and/or Faculty Lead
</button>
<div id="leadstaffinfo" class= "panel-collapse collapse">
                                    <div class="panel-body">
                                        <br>
                                        <div class="row centered" ><span class="addnameerror" style="color: #b60000"></span> </div>
                                       <div class="row">

                                            <div class="col-md-12">
                                                <div class="row">
<!--                                                    <div class="col-md-4">-->
<!--                                                        <label style="padding-top: 10px">First Name</label>-->
<!--                                                    </div>-->
                                                    <div class="col-md-4">
                                                        <label style="padding-top: 10px">First Name</label>
                                                        <input id='firstname'  type='text' class = "inputbox">
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label style="padding-top: 10px">Last Name</label>
                                                        <input id='lastname'  type='text' class = "inputbox">
                                                    </div>
                                                    <div class="col-md-1 centered">
<!--                                                        <div><br></div>-->
                                                <div class="input-group-append" >
                                                <i class="fa fa-plus-square fa-2x" style="padding-top: 40px" id="submitname" aria-hidden="true"></i>
                                            </div>
                                            </div>
                                                </div>
                                            </div>
                                       </div>
                                            <div style="display: none">
<!--                                                <div>-->
                                            {{ project.campus_lead_staff}}
                                            </div>
                                        <div class="row displaybox" id='display'>
                                        </div>

                                </div>

                                  </div>



 <div class="row justify-content-end" style="margin-top:30px;">
<div class="col-md-3" style="float: right">
<!--                    <p id="button-center"><button type="submit" class="save blackbutton" > <i class="fa fa-arrow-circle-right" style="color: white" aria-hidden="true"></i> Save as Draft</button></p>-->
            </div>
 </div>
        </div>

        <div id="step-3">

            <div class="row">
                <div class="col-md-3">
                    <label>
<!--                                 Primary Project Mission Area -->
                        Focus Area
                        <span style="color:red;">*</span>

                    </label>
                </div>
                <div class="col-md-6">


                   <select id="id_mission_area" class="form-control" name="id_mission_area">
                       <option value="0">--------</option>
                        {% for miss in mission_areas %}
                        {% if miss.selected == 'selected' %}
                        <option value={{miss.id}} selected="selected">{{miss.name}}</option>
                        {% else %}

                        <option value={{miss.id}}>{{miss.name}}</option>
                          {% endif %}
                        {% endfor %}
                     </select>
<!--{{proj_mission}}-->
                </div>
            </div>





<div class="row centered" ><span class="addcaterror" style="color: #b60000"></span> </div>
              {% for catform in formset_subcat_details %}
            <div class="row sub_category_edit-row">
                <div class="col-md-3">
                    <label>
<!--                                 Sub Category-->
                        Topics

                                </label>
                </div>
                <div class="col-md-6">
                    {{ catform | bootstrap}}
                </div>
                <div class="col-md-1">
                    <div class="input-group-append" >
                        <i class="fa fa-plus-square fa-2x add-sub_category-row" style="padding-top:8px" aria-hidden="true"></i>
                    </div>
                </div>
                    </div>


                                {% endfor %}
 <div class="sub_category_edit-fields displaybox row" id="sub_category_edit-fields"></div>
  <div class="row"><br><br></div>
            <div class="row centered" ><span class="addothercaterror" style="color: #b60000"></span> </div>
                                                            <div class="row" id="othersubinput" style="display: none">
                                                    <div class="col-md-3">
                                                        <label style="padding-top: 10px">Other Topics</label>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <input id='othersubcat' type="text" class="inputbox" placeholder="Add Other Topics">
                                                    </div>

                                                    <div class="col-md-1">
<!--                                                        <div><br></div>-->
                                                <div class="input-group-append" >
                                                <i class="fa fa-plus-square fa-2x" style="padding-top: 8px" id="addsubcat" aria-hidden="true"></i>
                                            </div>
                                            </div>
                                                </div>
                                            <div style="display: none">
<!--                                                <div>-->
                                            {{ project.other_sub_category}}
                                            </div>
                                        <div class="row displaybox" id='displaysub'>

                                        </div>



             <div class="row justify-content-end" style="margin-top:30px;">
<div class="col-md-3" style="float: right">
<!--                    <p id="button-center"><button type="submit" class="save blackbutton" > <i class="fa fa-arrow-circle-right" style="color: white" aria-hidden="true"></i> Save as Draft</button></p>-->
            </div>
 </div>
        </div>
        <div id="step-4">
            <div class="row"><br></div>
<!--                             <button type="button" class="collapsible card-header" style="background-color: lightgrey;height: 30px;padding:5px" data-toggle="collapse" href="#contactinfo">-->
<!--    <i class="fa fa-plus"></i> Address-->
<!--</button>-->
<div id="contactinfo" class= "panel-collapse collapse show">
                                <div class="panel-body">
                                        <br>

                                        <div class="row">

                                            <div class="col-md-6">
                                                <div class="row">
                                              <label class="col-sm-4">Address</label>
                                            <div class="col-sm-7">
                                              {{ project.address_line1}}
                                            </div>
                                              {% if  project.address_line1.errors %} {% for error in  project.address_line1.errors %}
                                              <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                              {% endfor %} {% endif %}
                                          </div>
                                        </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">

                                        <div class="row">
                                              <label class="col-sm-4">City</label>
                                            <div class="col-sm-7">
                                            {{ project.city }}
                                            </div>
                                            {% if  project.city.errors %} {% for error in  project.city.errors %}
                                            <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                            {% endfor %} {% endif %}
                                                </div>
                                             <div class="row">
                                              <label class="col-sm-4">Country</label>
                                            <div class="col-sm-7">
                                            {{ project.country }}
                                            </div>
                                            {% if  project.country.errors %} {% for error in  project.country.errors %}
                                            <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                            {% endfor %} {% endif %}
                                        </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row">
                                              <label class="col-sm-4">State </label>
                                            <div class="col-sm-7">
                                            {{ project.state }}
                                            </div>
                                            {% if  project.state.errors %} {% for error in  project.state.errors %}
                                            <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                            {% endfor %} {% endif %}
                                                </div>
                                                  <div class="row">
                                              <label class="col-sm-4">Zip Code</label>
                                            <div class="col-sm-7">
                                            {{ project.zip }}
                                            </div>
                                            {% if  project.zip.errors %} {% for error in  project.zip.errors %}
                                            <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div>
                                            {% endfor %} {% endif %}
                                                </div>



                                            </div>
                                        </div>

                                </div>
     <div class="form-group" style="display: none">
                                            <label>Project Status</label>
                                            {{ project.status}}
                                            {% if  project.status.errors %} {% for error in  project.status.errors %} <div class="alert alert-danger"><strong>{{ error|escape }}</strong></div> {% endfor %} {% endif %}

                                        </div>
                              </div>

<!--            <div class="row justify-content-md-center" style="margin-top:30px;">-->
<!--                <div class="col-lg-2 col-md-5">-->
<!--                    <p id="button-center"><button type="submit" class="save btn-custom" style="background-color: #333"> <i class="fa fa-arrow-circle-right" aria-hidden="true"></i>Submit</button></p>-->
<!--                </div>-->

<!--                <div class="col-lg-2 col-md-5">-->
<!--                    <p id="button-center"><button type="submit" class="save btn-custom" style="background-color: #333"> <i class="fa fa-arrow-circle-right" aria-hidden="true"></i>Draft</button></p>-->
<!--                </div>-->
<!--            </div>-->

                                </div>



        </div>

    </div>
    <div class="container-fluid">

                 <div class="row centered" id="termsdiv">
                <p><input onchange="this.setCustomValidity(validity.valueMissing ? 'Please accept the Terms and Conditions' : '');" type="checkbox" id="terms">
                    I agree to the <a style="color: #d71920" href="https://unocpi.s3.amazonaws.com/documents/Terms_and_Conditions.pdf" target="_blank">Terms & Conditions</a>
                    of the Community Partnership Initiative.</p>
            </div>
                               <div class="row centered" style="margin-top:30px;">
<!--<div class="col-md-3">-->
                 <button type="submit" value="draft" name="draft" id="draft" class="save btn btn-secondary" >Save as Draft</button>
<!--            </div>-->
<button type="submit" value="update" name="update" id="update" class="save btn btn-secondary" > Update</button>
                 <button type="submit" value="submit" name="submit" id="submit" class="save btn btn-secondary">  Submit</button>
                <button name="cancel" id="cancel" class="btn btn-cancel"> Cancel</button>
 </div>
    </div>
</div>
            </div>
    </div>
</div>
</form>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.11.5/validator.min.js"></script>-->
<!--<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>-->
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>-->
<!--<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" />-->
<!--<script src="https://ajax.microsoft.com/ajax/jquery.validate/1.5.5/jquery.validate.min.js"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>-->
<!--<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>-->
<script type="text/javascript">
$(document).ready(function(){
    $('#smartwizard').smartWizard({
        theme:'arrows',
        transitionEffect: 'fade',
        transitionSpeed: '400',
        // usehash: false,
        showStepURLhash:false,
        // contentCache:true,
        toolbarSettings: {
            // toolbarPosition:'top',
            toolbarButtonPosition:'right',
            showNextButton:'true',
            showPreviousButton:'true',
            // toolbarExtraButtons: [
            //     $('<button></button>').text(' Cancel').addClass('btn-red').on('click', function () {
            //         if (confirm("Are you sure?")){
            //           window.location = '/checkProject';
            //         }
            //     }),
            //
            // ]
        }
    });
    //------------------hide and show buttons-----------------------
     $('.sw-btn-prev').hide();
                $('.sw-btn-next').show();
$('#termsdiv').hide();
$('#draft').hide();
$('#submit').hide();
$('#update').hide();
$('#otheractivity').hide();
var projectname = $('#id_project_name').val();
var splitproject = projectname.split(':');
$('#id_project_name').val(splitproject[0]);
var activity = $('#id_activity_type option:selected').text();
if(activity === 'Other'){
   $('#otheractivity').show();
}
$('#id_populate_activity').change(function () {
    var activityval = $('#id_populate_activity option:selected').val();
    var activity = $('#id_populate_activity option:selected').text();
    $('#id_activity_type').val(activityval);
if(activity === 'Other'){
   $('#otheractivity').show();
}
else{
    $('#otheractivity').hide()
}
});
//--------------order academic years--------------------
    var sel = $('#id_academic_year');
$(sel).html($("option", $(sel)).sort(function(a, b) {
    var arel = parseInt($(a).attr('value'), 10) || 0;
    var brel = parseInt($(b).attr('value'), 10)|| 0;
    return arel == brel ? 0 : arel > brel ? -1 : 1
}));
        var sel1 = $('#id_end_academic_year');
$(sel1).html($("option", $(sel1)).sort(function(a, b) {
    var arel1 = parseInt($(a).attr('value'), 10) || 0;
    var brel1 = parseInt($(b).attr('value'), 10)|| 0;
    return arel1 == brel1 ? 0 : arel1 > brel1 ? -1 : 1
}));
    var status = $('#id_status option:selected').text();
    if(status === 'Drafts'){
$('#draft').show();
$('#submit').show();
    }
    else{
$('#draft').hide();
$('#submit').hide();
$('#update').show;
    }
    //--------------------cancel button function------------------------
        $('#cancel').on('click', function (e) {
            e.preventDefault();
                    if (confirm("You will be redirected back to check project page and the changes will be lost. Are you sure, you want to cancel editing project?")){
                      window.location = '/checkProject';
                    }
        });
    //----------------------form wizard each step validation---------------------------
    $("#smartwizard").on("leaveStep", function(e, anchorObject, stepNumber, stepDirection) {
        var elmForm = $("#form-step-" + stepNumber);
        if (stepDirection === 'forward') {
            if (stepNumber === 0) {
                $('.sw-btn-prev').show();
                $('.sw-btn-next').show();
                if (($("#id_project_name").val() === '')) {
                    alert("Please provide Project name to proceed.");
                    return false
                }
                if (($("#id_engagement_type").val() === '')) {
                    alert("Please Select Engagement type.");
                    return false
                }
                 if($('#otheracttype').val() !="" ){
                    alert('Please Make Sure To Add The Other Activity Value');
                   var html = "<i class='fa fa-exclamation-triangle' style='color:orange'></i>Please add other activity type.";
                    $('.addactivityerror').append(html);
                    return false;
                }
                if (($("#id_semester").val() === '')) {
                    alert("Please provide Project start semester.");
                    return false
                }
                // if ($("#id_academic_year").val() === '') {
                //     alert("Please provide Project start academic year.");
                //     return false
                // }
                if( ($("#id_description").val() === '') ){
                    alert("Please Provide Description for the project.");
                    return false
                }

                 var fromacademicyear=$("#id_academic_year").val();
                var toacademicyear=$("#id_end_academic_year").val();
                if (toacademicyear != '') {
                    if (toacademicyear < fromacademicyear) {
                        alert("Please Check Start and End Academic Years");
                        return false;
                    }
                }
                if (status === 'Drafts') {
                    $('#termsdiv').hide();
                    $('#draft').show();
                    $('#submit').hide();
                    $('#update').hide();
                } else {
                    $('#termsdiv').hide();
                    $('#draft').hide();
                    $('#submit').hide();
                    $('#update').hide();
                }
            }
            if (stepNumber === 1) {
                 $('.sw-btn-prev').show();
                $('.sw-btn-next').show();
                        var communitylast = $('.community_edit-row:last').find(':selected').text();
        var campuslast = $('.campus_edit-row:last').find(':selected').text();
        if(communitylast !='---------' && communitylast != ""){
            alert('Please make sure to add the selected value');
            var html = "<i class='fa fa-exclamation-triangle' style='color:orange'></i>Please add selected community partner.";
                    $('.addcommerror').append(html);
            return false;
        }
        if(campuslast !='---------' && campuslast != ""){
            alert('Please make sure to add the selected value');
             var html = "<i class='fa fa-exclamation-triangle' style='color:orange'></i>Please add selected campus partner.";
                    $('.addcamperror').append(html);
            return false;
        }
         if($('#firstname').val() !="" && $('#lastname') != ""){
            alert('Please make sure to add the Lead Staff Name');
             var html = "<i class='fa fa-exclamation-triangle' style='color:orange'></i>Please add lead/faculty staff name.";
                    $('.addnameerror').append(html);
            return false;
        }
                if ($("#id_campus_edit-0-campus_partner").val() === '') {
                    alert("Please provide Campus partner before proceeding.");
                    return false;
                }
                if (status === 'Drafts') {
                    $('#termsdiv').hide();
                    $('#draft').show();
                    $('#submit').hide();
                    $('#update').hide();
                } else {
                    $('#termsdiv').hide();
                    $('#draft').hide();
                    $('#submit').hide();
                    $('#update').hide();
                }
            }
            if (stepNumber === 2) {
                var subcatlast = $('.sub_category_edit-row:last').find(':selected').text();
        if(subcatlast !='---------' && subcatlast != ""){
            alert('Please make sure to add the selected value');
             var html = "<i class='fa fa-exclamation-triangle' style='color:orange'></i>Please add selected topic.";
                    $('.addcaterror').append(html);
            return false;
        }
        if($('#othersubcat').val() !=""){
            alert('Please make sure to add the other topic');
             var html = "<i class='fa fa-exclamation-triangle' style='color:orange'></i>Please add other topic.";
                    $('.addothercaterror').append(html);
            return false;
        }


                if ($("#id_mission_area").val() === '0') {
                    alert("Please provide Focus Area before proceeding.");
                    return false;
                } else {
                    $('.sw-btn-prev').show();
                $('.sw-btn-next').hide();
                    if (status === 'Drafts') {
                        $('#termsdiv').show();
                        $('#draft').show();
                        $('#submit').show();
                        $('#update').hide();
                    } else {
                        $('#termsdiv').show();
                        $('#draft').hide();
                        $('#submit').hide();
                        $('#update').show();
                    }
                }
            }
        }
    //------------------------wizard step backward buttons function-----------------
if (stepDirection === 'backward') {
if (stepNumber === 1) {
    $('.sw-btn-prev').hide();
    $('.sw-btn-next').show();
}
    // $('.sw-btn-prev').show();
    $('.sw-btn-next').show();
            if(status === 'Drafts') {
           $('#termsdiv').hide();
            $('#draft').show();
            $('#submit').hide();
            $('#update').hide();
        }
        else{
            $('#termsdiv').hide();
             $('#draft').hide();
            $('#submit').hide();
            $('#update').hide();
        }
        }
        return true;
    });
        //-------------------buttons function if directly click on step 1-----------------
    $('#click1').click(function () {
        $('.sw-btn-prev').hide();
        $('.sw-btn-next').show();
    });
    //-------------------buttons function if directly click on step 4-----------------
    $('#click4').click(function () {
         if($('#click4').hasClass('active')) {
             $('.sw-btn-prev').show();
             $('.sw-btn-next').hide();
         }
        if (status === 'Drafts') {
                        $('#termsdiv').show();
                        $('#draft').show();
                        $('#submit').show();
                        $('#update').hide();
                    } else {
                        $('#termsdiv').show();
                        $('#draft').hide();
                        $('#submit').hide();
                        $('#update').show();
                    }
    });
    //----------------------------saving focus area---------------------
    $('.save').click(function () {
       var focusarea = $('#id_mission_area').val();
       if(focusarea != "0"){
           $.ajax({
        url: "/saveFocusArea/",
       //url:"/partners/registerCommunityPartnerForProject/",
        data: {
            'focusarea': document.getElementById("id_mission_area").value,
            'projectId':document.getElementById('id_projectId').value
        },
    });
       }
    });





    $('#id_project_name').addClass('inputbox');
    $('#submit').hide();
    // $('#othersubinput').hide();
    $("#k12-students").hide();
    $('#step-2').hide();
    $('#step-3').hide();
    $("#step-4").hide();
        $(".collapse.show").each(function(){
        	$(this).prev(".card-header").find(".fa").addClass("fa-minus").removeClass("fa-plus");
        });
        // Toggle plus minus icon on show hide of collapse element
        $(".collapse").on('show.bs.collapse', function(){
        	$(this).prev(".card-header").find(".fa").removeClass("fa-plus").addClass("fa-minus");
        }).on('hide.bs.collapse', function(){
        	$(this).prev(".card-header").find(".fa").removeClass("fa-minus").addClass("fa-plus");
        });
$('#id_total_uno_students').addClass('nospecial').attr('size','3');
$('#id_total_uno_hours').addClass('nospecial');
$('#id_total_k12_students').addClass('nospecial');
$('#id_total_k12_hours').addClass('nospecial');
$(".nospecial").keypress(function (e) {
            var keyCode = e.keyCode || e.which;
            $(this).addClass(' ');
            //Regex for Valid Characters i.e. Alphabets and Numbers.
            var regex = /^[0-9]+$/;
            //Validate TextBox value against the Regex.
            var isValid = regex.test(String.fromCharCode(keyCode));
            if (!isValid) {
                return false;
            }
            return isValid;
        });

});
//----------------------------------restrict comma and semicolon---------------------------
     function RestrictCommaSemicolon(e) {
        var theEvent = e || window.event;
        var key = theEvent.keyCode || theEvent.which;
        key = String.fromCharCode(key);
        var regex = /[^,;]+$/;
        if (!regex.test(key)) {
            theEvent.returnValue = false;
            if (theEvent.preventDefault) {
                theEvent.preventDefault();
            }
        }
    }
        $('#firstname').attr('onkeypress', 'return RestrictCommaSemicolon(event);');
    $('#lastname').attr('onkeypress', 'return RestrictCommaSemicolon(event);');
    $('#otheracttype').attr('onkeypress', 'return RestrictCommaSemicolon(event);');
    $('#othersubcat').attr('onkeypress', 'return RestrictCommaSemicolon(event);');
</script>
<br><br><br><br><br><br><br><br><br><br>
{% endblock %}


{% block custom_js %}
{#<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>#}
<script type="text/javascript">
    //Lead staff, Other sub Category and Other activity array list display function
    var leadstaff = $('#id_campus_lead_staff').val();
    if(leadstaff != '') {
        var splitleadstaff = leadstaff.split(',');
        for (var i = 0; i < splitleadstaff.length; i++) {
            var html = '<div class="concat"><h6 class="finalname" style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + splitleadstaff[i] + '<i  onclick="myFunction()" class="remove-staff fa fa-close"></i> </h6></div>';
            $("#display").append(html);
        }
    }
    var othersubcat = $('#id_other_sub_category').val();
    if (othersubcat != '') {
        var splitothersubcat = othersubcat.split(',');
        for (var j = 0; j < splitothersubcat.length; j++) {
            var htmlother = '<div class="subcat"><h6 class="finalcat" style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + splitothersubcat[j] + '<i  onclick="myFunction()" class="remove-subcat fa fa-close"></i> </h6></div>';
            $("#displaysub").append(htmlother);
        }
    }
       var otheract = $('#id_other_activity_type').val();
    if (otheract != '') {
        var splitotheract = otheract.split(',');
        for (var k = 0; k < splitotheract.length; k++) {
            var htmlotheract = '<div class="act"><h6 class="finalact" style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + splitotheract[k] + '<i  onclick="myFunction()" class="remove-act fa fa-close"></i> </h6></div>';
            $("#displayact").append(htmlotheract);
        }
    }
//-----------------------add additional other sub category-----------------------
        $("#addsubcat").click(function () {
            $('.addothercaterror').empty();
var str = "";
var name =  $('.subcat > h6.finalcat').length;
//alert(name);
if(name === 10) {
            alert("Only Upto 10 Topics are allowed");
                $('#othersubcat').val('');
            return false;
        }
else {
    var disp = $('#othersubcat').val();
    if (disp === "") {
        alert("Please enter topic name")
    } else {
        var html = '<div class="subcat"><h6 class="finalcat" style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + disp + '<i name="' + name + '" onclick="myFunction()" class="remove-subcat fa fa-close"></i> </h6></div>';
        $("#displaysub").append(html);
        $('.subcat > h6.finalcat').each(function () {
            str += $(this).text() + ",";
        });
        var str2 = str.substring(0, str.length - 1);
        $('#id_other_sub_category').val(str2);
        $('#othersubcat').val('');
    }
}
    });
    //-----------------------add additional Lead staff name-----------------------
    $("#submitname").click(function () {
        $('.addnameerror').empty();
var str = "";
var name =  $('.concat > h6.finalname').length;
//alert(name);
if(name === 10) {
            alert("Only Upto 10 staff members are allowed");
                $('#firstname').val('');
    $('#lastname').val('');
            return false;
        }
else {
    var disp = $('#firstname').val() + ' ' + $('#lastname').val();
    if (disp === " ") {
        alert("Please enter the name of the Campus Lead Staff")
    } else {
        var html = '<div class="concat"><h6 class="finalname" style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + disp + '<i name="' + name + '" onclick="myFunction()" class="remove-staff fa fa-close"></i> </h6></div>';
        $("#display").append(html);
        $('.concat > h6.finalname').each(function () {
            str += $(this).text() + ",";
        });
        var str2 = str.substring(0, str.length - 1);
        $('#id_campus_lead_staff').val(str2);
        $('#firstname').val('');
        $('#lastname').val('');
    }
}
    });
      //------------------add additional other activity type--------------------
            $("#addotheract").click(function () {
                $('.addactivityerror').empty();
var str = "";
var name =  $('.act > h6.finalact').length;
//alert(name);
if(name === 10) {
            alert("Only Upto 10 activity types are allowed");
                $('#otheracttype').val('');
            return false;
        }
else {
    var disp = $('#otheracttype').val();
    if (disp === "") {
        alert("Please enter the activity type")
    } else {
        var html = '<div class="act"><h6 class="finalact" style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + disp + '<i name="' + name + '" onclick="myFunction()" class="remove-act fa fa-close"></i> </h6></div>';
        $("#displayact").append(html);
        $('.act > h6.finalact').each(function () {
            str += $(this).text() + ",";
        });
        var str2 = str.substring(0, str.length - 1);
        $('#id_other_activity_type').val(str2);
        $('#otheracttype').val('');
    }
}
    });
//-----------------------remove additional activity in array list-----------------------
            $(document).on('click', '.remove-act', function(e){
    e.preventDefault();
    $(this).parent().remove();
    var str = "";
                $('.act > h6.finalact').each(function(){
                     str += $(this).text()+ ",";
                });
 var str2 = str.substring(0,str.length-1);
                $('#id_other_activity_type').val(str2);
                // $('#id_campus_lead_staff').val(str);
    return false;
});
            //-----------------------remove additional lead staff in array list-----------------------
    $(document).on('click', '.remove-staff', function(e){
    e.preventDefault();
    $(this).parent().remove();
    var str = "";
                $('.concat > h6.finalname').each(function(){
                     str += $(this).text()+ ",";
                });
 var str2 = str.substring(0,str.length-1);
                $('#id_campus_lead_staff').val(str2);
                // $('#id_campus_lead_staff').val(str);
    return false;
});
    //-----------------------remove additional sub category in array list-----------------------
                $(document).on('click', '.remove-subcat', function(e){
    e.preventDefault();
    $(this).parent().remove();
    var str = "";
                $('.subcat > h6.finalcat').each(function(){
                     str += $(this).text()+ ",";
                });
 var str2 = str.substring(0,str.length-1);
                $('#id_other_sub_category').val(str2);
                // $('#id_campus_lead_staff').val(str);
    return false;
});
    function updateElementIndex(el, prefix, ndx) {
    var id_regex = new RegExp('(' + prefix + '-\\d+)');
    var replacement = prefix + '-' + ndx;
    if ($(el).attr("for")) $(el).attr("for", $(el).attr("for").replace(id_regex, replacement));
    if (el.id) el.id = el.id.replace(id_regex, replacement);
    if (el.name) el.name = el.name.replace(id_regex, replacement);
}
//--------------------to count click for clone more which excludes previously added partner and only new partner id's are considered-------------------
     var clickscomm = 0;
    function clickCommunity() {
        clickscomm += 1;
 }
     var clickscamp = 0;
    function clickCampus() {
        clickscamp += 1;
 }
var community_ids = [];
var campus_ids = [];
var subcategory_ids=[];
var new_community_ids = [];
var new_campus_ids = [];
$("#id_registerCommAndSave").click(function (){
   var projecId = document.getElementById('id_projectId').value;
    var result = confirm("You will be redirected to page where you can register your partner.Upon Submission of the registration form, you will be redirected back to this page to create a new project.Are you sure you want to register a New Community Partner?");
    if (result == true) {
    var commIdList = ''
    if (new_community_ids.length >=1) {
        commIdList  = String(new_community_ids);
    }
    var campIdList = ''
    if (new_campus_ids.length >=1) {
        campIdList  = String(new_campus_ids);
    }
     $.ajax({
        url: "/saveProjectAndRegister/",
        data: {
            'name': document.getElementById("id_project_name").value,
            'description':document.getElementById("id_description").value,
            'engagement_type':document.getElementById("id_engagement_type").value,
            'activity_type':document.getElementById("id_populate_activity").value,
            'start_semester':document.getElementById("id_semester").value,
            'start_academic_yr':document.getElementById("id_academic_year").value,
            'end_semester':document.getElementById("id_end_semester").value,
            'end_academic_yr':document.getElementById("id_end_academic_year").value,
            'uno_students':document.getElementById("id_total_uno_students").value,
            'uno_students_hrs':document.getElementById("id_total_uno_hours").value,
            'k12_students':document.getElementById("id_total_k12_students").value,
            'k12_students_hrs':document.getElementById("id_total_k12_hours").value,
            'k12_involvment_flag':document.getElementById("id_k12_flag").value,
            'selectedCommIds':commIdList,
            'selectedCampusIds':campIdList,
            'project_type':document.getElementById("id_project_type").value,
            'lead_staff_list':document.getElementById("id_campus_lead_staff").value,
            'projectId':projecId
        },
        dataType: 'json',
        success: function (data) {
           window.location = '/partners/registerCommunityPartnerForProject/?projectId='+data.save_projectId
        }
    });
 }
});
$("#id_registerCampusAndSave").click(function (){
    var result = confirm("You will be redirected to page where you can register your partner.Upon Submission of the registration form, you will be redirected back to this page to create a new project. Are you sure you want to register a New Campus Partner?");
    var projecId = document.getElementById('id_projectId').value;
    if (result == true) {
    var commIdList = ''
    if (new_community_ids.length >=1) {
        commIdList  = String(new_community_ids);
    }
    var campIdList = ''
    if (new_campus_ids.length >=1) {
        campIdList  = String(new_campus_ids);
    }
     $.ajax({
        url: "/saveProjectAndRegister/",
       //url:"/partners/registerCommunityPartnerForProject/",
        data: {
            'name': document.getElementById("id_project_name").value,
            'description':document.getElementById("id_description").value,
            'engagement_type':document.getElementById("id_engagement_type").value,
            'activity_type':document.getElementById("id_populate_activity").value,
            'start_semester':document.getElementById("id_semester").value,
            'start_academic_yr':document.getElementById("id_academic_year").value,
            'end_semester':document.getElementById("id_end_semester").value,
            'end_academic_yr':document.getElementById("id_end_academic_year").value,
            'uno_students':document.getElementById("id_total_uno_students").value,
            'uno_students_hrs':document.getElementById("id_total_uno_hours").value,
            'k12_students':document.getElementById("id_total_k12_students").value,
            'k12_students_hrs':document.getElementById("id_total_k12_hours").value,
            'k12_involvment_flag':document.getElementById("id_k12_flag").value,
            'selectedCommIds':commIdList,
            'selectedCampusIds':campIdList,
            'project_type':document.getElementById("id_project_type").value,
            'lead_staff_list':document.getElementById("id_campus_lead_staff").value,
            'projectId':projecId
        },
        dataType: 'json',
        success: function (data) {
           window.location = '/partners/registerCampusPartnerForProject/?projectId='+data.save_projectId
        }
    });
 }
});
function cloneMore(selector, prefix) {
    // $(this).parent().fadeout();
       var selected = $(selector).find(':selected').val();
       var selectedtext = $(selector).find(':selected').text();
    if (selectedtext == '---------') {
        alert('you cannot add empty value');
        $(selector).find('select').val(' ');
        return;
    }
    if (prefix == 'community_edit') {
        if (community_ids.includes(selected)) {
            alert('community already added');
            $(selector).find('select').val(' ');
            return;
        }
        if(clickscomm > 1){
            new_community_ids.push(selected)
        }
        community_ids.push(selected);
    } else if (prefix == 'campus_edit') {
        if (campus_ids.includes(selected)) {
            alert('campus already added');
            $(selector).find('select').val(' ');
            return;
        }
        if(clickscamp > 1){
            new_campus_ids.push(selected)
        }
        campus_ids.push(selected);
    }
    else if (prefix=='sub_category_edit'){
        if (subcategory_ids.includes(selected)){
            alert('Subcategory already added');
            $(selector).find('select').val(' ');
            return;
        }
        subcategory_ids.push(selected);
    }
    var newElement = $(selector).clone(true);
    var total = $('#id_' + prefix + '-TOTAL_FORMS').val();
    newElement.find(':input').each(function() {
        var name = $(this).attr('name');
        if(name) {
             var selectedcommunity = $('#id_'+name+' option:selected').text();
             var value = $('#id_'+name+' option:selected').val();
             if(selectedcommunity != '') {
                 console.log(selectedcommunity);
                 // selectedcommunity.each(function(){
                 var html = '<h6 style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + selectedcommunity + '  <i name="' + name + '" class="remove-' + prefix + '-row fa fa-close" data-id="' + value + '"></i> </h6>';
                 $("#" + prefix + "-fields").append(html);
                 // });
             }
             if(selectedcommunity === 'Others'){
                 $('#othersubinput').show();
             }
             // else{
             //     $('#othersubinput').hide();
             // }
        }
        // if(name.includes("DELETE")){
        //     $(this).hide();
        // }
            name = name.replace('-' + (total-1) + '-', '-' + total + '-');
            var id = 'id_' + name;
            $(this).attr({'name': name, 'id': id}).val('').removeAttr('checked');
            // $('#'+id).find('[value='+value+']').remove();
    });
    total++;
    $('#id_' + prefix + '-TOTAL_FORMS').val(total);
    $(selector).after(newElement);
    var conditionRow = $('.'+ prefix + '-row:not(:last)');
    conditionRow.hide() ;
    // var selectedcommunity = $('#id_'+name+' option:selected').text();
      //     console.log(selectedcommunity);
      //   var html = '<div class="community_partner" name="community_partner">'+selectedcommunity+'<i class="remove-'+prefix+'-row fa fa-trash"></i> </div>';
      //   $("#copy-fields").append(html);
    // var conditionlast = $('.'+prefix+'-row:last');
    // conditionlast.show();
    conditionRow.find('.fa.add-' + prefix +'-row')
    .removeClass('fa-plus-square').addClass('fa fa-minus-square').addClass('delicon')
    .removeClass('add-' + prefix + '-row').addClass('remove-' + prefix + '-row')
    .html(' ');
    return false;
}
//$('.community-row:not(:last)').hide();
//$('.community-row:last').show();
// function existingselectedvalues(prefix, elem){
//     if(prefix == 'community'){
//         var index = community_ids.indexOf(selected);
//         if (index > 0){
//             prefix.forEach(
//             var html = '<h6 style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + selectedcommunity + '  <i name="' + name + '" class="remove-' + prefix + '-row fa fa-close" data-id="' + value + '"></i> </h6>';
//                  $("#"+prefix+"-fields").show().append()
//         )}
//
//
//     }
//
// }
function deleteForm(prefix, elem) {
    var name = elem.attr('name');
    var splitname = name.split('-');
    var btn = splitname[0]+'-'+splitname[1];
    $('#id_'+btn+'-DELETE').prop('checked',true);
    //console.log("delete happening");
    var selected = elem.attr('data-id');
        if (prefix == 'community_edit') {
        var index = community_ids.indexOf(selected);
        if (index != -1) community_ids.splice(index, 1);
        var newindex = new_community_ids.indexOf(selected);
        if (newindex != -1) new_community_ids.splice(index, 1);
    } else if (prefix == 'campus_edit') {
        var index = campus_ids.indexOf(selected);
        if (index != -1) campus_ids.splice(index, 1);
        var newindex = new_campus_ids.indexOf(selected);
        if (newindex != -1) new_campus_ids.splice(index, 1);
    }
    else if(prefix=='sub_category_edit'){
        var index = subcategory_ids.indexOf(selected);
        if (index !=-1) subcategory_ids.splice(index,1);
    }
  var total = parseInt($('#id_' + prefix + '-TOTAL_FORMS').val());
  console.log('In deleteForm - total', total);
  if (total > 1) {
    // $('#id_'+btn).closest('.community_partner').remove();
    // btn.closest('.' + prefix + '-row').remove();
    var forms = $('.' + prefix + '-row');
    $('#id_' + prefix + '-TOTAL_FORMS').val(forms.length);
    for (var i = 0, formCount = forms.length; i < formCount; i++) {
      $(forms.get(i))
        .find(':input')
        .each(function() {
          updateElementIndex(this, prefix, i);
        });
    }
  }
  return false;
}
$(document).on('click', '.add-mission-row', function(e){
    e.preventDefault();
    cloneMore('.mission-row:last', 'mission');
    return false;
});
$(document).on('click', '.add-sub_category-row', function(e){
    e.preventDefault();
    $('.addcaterror').empty();
    cloneMore('.sub_category_edit-row:last', 'sub_category_edit');
    return false;
});
$(document).on('click', '.add-secondary_mission-row', function(e){
    e.preventDefault();
    cloneMore('.secondary_mission-row:last', 'secondary_mission');
    return false;
});
$(document).on('click', '.add-community-row', function(e){
    e.preventDefault();
    $('.addcommerror').empty();
    cloneMore('.community_edit-row:last', 'community_edit');
    // $('.community-row:not(:last)').hide();
    // var name = $(this).attr('name');
          // var selectedcommunity = $('#id_'+name+' option:selected').text();
          // console.log(selectedcommunity);
        // var html = '<div class="community_partner" name="community_partner">'+selectedcommunity+'<i class="remove-community-row fa fa-trash"></i> </div>';
  // '</div>'+
  // '<div class="form-group">'+
  // '<button class="btn blackbutton remove" type="button">x</button>'+
  // '</div>';
  //       $("#copy-fields").append(html);
    return false;
});
$(document).on('click', '.add-campus-row', function(e){
    e.preventDefault();
    $('.addcamperror').empty();
    cloneMore('.campus_edit-row:last', 'campus_edit');
    return false;
});
$(document).on('click', '.remove-mission-row', function(e){
    e.preventDefault();
    deleteForm('mission', $(this));
    return false;
});
$(document).on('click', '.remove-secondary_mission-row', function(e){
    e.preventDefault();
    deleteForm('secondary_mission', $(this));
    return false;
});
$(document).on('click', '.remove-community_edit-row', function(e){
    e.preventDefault();
   $(this).parent().remove();
    deleteForm('community_edit', $(this));
    return false;
});
$(document).on('click', '.remove-campus_edit-row', function(e){
    e.preventDefault();
    $(this).parent().remove();
    deleteForm('campus_edit', $(this));
    return false;
});
$(document).on('click', '.remove-sub_category_edit-row', function(e){
    e.preventDefault();
    $(this).parent().remove();
    deleteForm('sub_category_edit', $(this));
    return false;
});
</script>
{#   Js to show the course form if some error happens after the form #}
<script>
    $('.community_edit-row').find('select').not(':last').each(function() {
        var name = $(this).attr('name');
        if(name) {
             var selectedcommunity = $('#id_'+name+' option:selected').text();
             var selectedcommunityval = $('#id_'+name+' option:selected').val();
             if(selectedcommunity != '') {
                 console.log(selectedcommunity);
                 // selectedcommunity.each(function(){
                 var html = '<h6 style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + selectedcommunity + '  <i name="' + name + '" class="remove-community_edit-row fa fa-close"></i> </h6>';
                 $("#community_edit-fields").append(html);
                 // });
             }
             community_ids.push(selectedcommunityval)
        }
    });
        $('.campus_edit-row').find('select').not(':last').each(function() {
        var campname = $(this).attr('name');
        if(campname) {
             var selectedcampus = $('#id_'+campname+' option:selected').text();
            var selectedcampusval = $('#id_'+campname+' option:selected').val();
             if(selectedcampus != '') {
                 console.log(selectedcampus);
                 // selectedcommunity.each(function(){
                 var html = '<h6 style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + selectedcampus + '  <i name="' + campname + '" class="remove-campus_edit-row fa fa-close"></i> </h6>';
                 $("#campus_edit-fields").append(html);
                 // });
             }
             campus_ids.push(selectedcampusval);
        }
    });
            $('.sub_category_edit-row').find('select').not(':last').each(function() {
        var subcat = $(this).attr('name');
        if(subcat) {
             var selectedcat = $('#id_'+subcat+' option:selected').text();
             var selectedcatval = $('#id_'+subcat+' option:selected').val();
             if(selectedcat != '') {
                 console.log(selectedcat);
                 var html = '<h6 style="border:1px black solid;padding:5px;margin: 5px;border-radius: 10px">' + selectedcat + '  <i name="' + subcat + '" class="remove-sub_category_edit-row fa fa-close"></i> </h6>';
                 $("#sub_category_edit-fields").append(html);
             }
             subcategory_ids.push(selectedcatval);
             if(selectedcat === 'Others'){
                 $('#othersubinput').show();
             }
              // else{
              //    $('#othersubinput').hide();
             // }
        }
    });
            window.onload = function () {
//------------hide and show k-12 flag ---------------------
$('#id_k12_flag').change(function () {
    if($('#id_k12_flag').prop('checked')==true){
        $("#k12-students").show();
    }
    else{
        $("#k12-students").hide();
    }
});
//----------------page on load formset click function--------------------
        var communitylast = $('.community_edit-row:last').find(':selected').text();
        var campuslast = $('.campus_edit-row:last').find(':selected').text();
         var subcatlast = $('.sub_category_edit-row:last').find(':selected').text();
       if(communitylast != '---------') {
           $('.add-community-row:last').click();
       }
       if( campuslast != '---------') {
           $('.add-campus-row:last').click();
       }
       if(subcatlast != '---------') {
           $('.add-sub_category-row:last').click();
       }
//---------------------------academic year validation ----------------------------
        $("#id_end_academic_year").change(function () {
        var fromacademicyear=$("#id_academic_year").val();
        var toacademicyear=$("#id_end_academic_year").val();
        if (toacademicyear<fromacademicyear ){
            alert("Please Check Start and End Academic Years");
            // $("#id_end_academic_year").val('-------- ');
            // $("#id_academic_year").val(' ');
            return false;
        }
    });
    $("#id_academic_year").change(function () {
        var fromacademicyear=$("#id_academic_year").val();
        var toacademicyear=$("#id_end_academic_year").val();
        if (toacademicyear!='') {
            if (fromacademicyear > toacademicyear || toacademicyear < fromacademicyear) {
                alert("Please Check Start and End Academic Years");
                // $("#id_end_academic_year").val(' ');
                // $("#id_academic_year").val(' ');
                return false;
            }
        }
    });
$('#id_engagement_type').change(function () {
    var selectedEngagement = $('#id_engagement_type option:selected').text();
    $.ajax({
        url: "/getEngagemetActivityList/",
        data: {
            'selectedEngagement': selectedEngagement
        },
        dataType: 'json',
        success: function (data) {
            var activityList = data.activityList
            var options = '<option value="0">--------</option>';
            for (var i = 0; i < activityList.length; i++) {
                options += '<option value="' + activityList[i].id + '">' + activityList[i].name + '</option>';
            }
            $("select#id_populate_activity").html(options);
            $("select#id_populate_activity option:first").attr('selected', 'selected');
            $("select#id_populate_activity").attr('disabled', false);
        }
    });

});
  var val = $("#id_activity_type").find("option:selected").text();
           if (val === 'Course') {
              $("#id_name").show();
              $("label.control-label[for=id_name], input#id_name").show();
              // $("label.control-label[for=id_prefix], input#id_prefix").show();
              $("label.control-label[for=id_section], input#id_section").show();
           $("#id_prefix").show();
           $("label.control-label[for=id_number], input#id_number").show();
           $("#id_number").show();
           }
}
</script>
{#  JS to Hide the#}
<script>
   $(function() {
       function hideInputs() {
           $("label.control-label[for=id_name], input#id_name").hide();
           $("#id_id_name").hide();
           $("label.control-label[for=id_prefix], input#id_prefix").hide();
           $("#id_prefix").hide();
           $("label.control-label[for=id_number], input#id_number").hide();
           $("#id_number").hide();
           $("label.control-label[for=id_section], input#id_section").hide();
           $("#id_section").hide();
           console.log('label.control-label[for=id_name], input#id_name');
       }
       $("#id_activity_type").on('change', function () {
           var val = $("#id_activity_type").find("option:selected").text();
           console.log(val)
           if (val === 'Course') {
               $("#id_name").show();
               $("label.control-label[for=id_name], input#id_name").show();
               $("label.control-label[for=id_prefix], input#id_prefix").show();
               $("#id_prefix").show();
               $("label.control-label[for=id_number], input#id_number").show();
               $("#id_number").show();
               $("label.control-label[for=id_section], input#id_section").show();
               $("#id_section").show();
           }
           else {
               hideInputs();
           }
       });
       hideInputs();
   });
</script>

{% endblock %}


{% block selectizeForm %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/js/select2.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/css/select2.min.css">
<script>
$(document).ready(function(){
    $('.control-label').hide();
    $('.checkbox').hide();
    $('#id_project_type').select2({placeholder: 'Select Project Type',border:'2px solid #aaa'});
    $('#id_engagement_type').select2({placeholder: 'Select Engagement Type',border:'2px solid #aaa'});
    $('#id_populate_activity').select2({placeholder: 'Select Engagement Type',border:'2px solid #aaa'});

    $('#id_academic_year').select2({placeholder: 'Select Academic Year',});
    $('#id_status').select2({placeholder: 'Select Status',});
    $('#id_semester').select2({placeholder: 'Select Semester',});
    $('#id_end_semester').select2({placeholder: 'Select End Semester',});
    $('#id_end_academic_year').select2({placeholder: 'Select End Academic Year',});
    $('#id_address_line1').addClass('clearable');
               function tog(v){return v?'addClass':'removeClass';}
    $(document).on('input', '.clearable', function(){
    $(this)[tog(this.value)]('x');
       }).on('mousemove', '.x', function( e ){
    $(this)[tog(this.offsetWidth-18 < e.clientX-this.getBoundingClientRect().left)]('onX');
      }).on('touchstart click', '.onX', function( ev ){
    ev.preventDefault();
    $(this).removeClass('x onX').val('').change();
     });
});
 // document.getElementById("terms").setCustomValidity("Please accept the Terms and Conditions");
</script>
<style>
.select2-container .select2-selection--single
{
   height:32px;
}
.select2-container--default .select2-selection--single
{
   border: 1px solid #aaa;
   margin-top:8px;
}
.select2-container--default .select2-selection--single .select2-selection__arrow
{
   top:10px;
}
.select2-container--default .select2-selection--single:focus
{
  border-color:grey;
  box-shadow:0 0 8px 0 grey;
}
</style>

<!-- Adding script per ticket 723-->
<script>
$(document).ready(function () {
    $('#id_status').hide();
$('#draft').click(function(){
    $('#id_status option[value=5]').attr('selected','selected');
console.log('draft');
     if (($("#id_project_name").val() === '')) {
                    alert("Please Provide Project Name to Save.");
                    return false
                }
                if (($("#id_engagement_type").val() === '')) {
                    alert("Please Select Engagement type.");
                    return false
                }
                 if (($("#id_activity_type").val() === '')) {
                    alert("Please Select Activity type.");
                    return false
                }
                if ($("#id_academic_year").val() === '') {
                    alert("Please Select Start Academic Year to Save.");
                    return false
                }
});
$('#update').click(function () {
    if($('#terms').is(":checked")){
        return true;
    }
    else {
        alert("Please Accept the terms and conditions before submitting");
        return false;
    }
});
$('#submit').click(function () {
    if($('#terms').is(":checked")){
        $('#id_status option[value=1]').attr('selected','selected');
        return true;
    }
    else {
        alert("Please Accept the terms and conditions before submitting");
        return false;
    }
});
        window.onsubmit = function checking() {
        var id_name = document.getElementById('id_mission-0-mission');
        var id_campus = document.getElementById('id_campus-0-campus_partner');
        var val = id_name.options[id_name.selectedIndex].text;
        var val1 = id_campus.options[id_campus.selectedIndex].text;
        var location = document.getElementById("errorid").scrollTop;
        if (val === '---------') {
            error = "<div class='alert alert-danger'><strong>{{ 'Please select a Primary Mission Area'|escape }}</strong></div>";
            document.getElementById("errorid").innerHTML = error;
            document.documentElement.scrollTop = 900;
        }
        if (val1 === '---------') {
            error = "<div class='alert alert-danger'><strong>{{ 'Please select at least one Campus Partner'|escape }}</strong></div>";
            document.getElementById("errorid1").innerHTML = error;
            document.documentElement.scrollTop = 900;
            {#document.getElementById('id_community-0-community_partner').scrollIntoView();#}
            {#return false#}
        }
        if (val === '---------' || val1 === '---------') {
            return false
        }
        if (val !== '---------') {
            document.getElementById("errorid").innerHTML = "";
        }
        if (val1 !== '---------') {
            document.getElementById("errorid1").innerHTML = "";
        }
    }
});
</script>
<script>
$(function () {
         $('[data-toggle="popover"]').popover()
     })
</script>

{% endblock %}